import 'package:flutter/widgets.dart';
import '../../component_example_models.dart';
import 'sortable_example_1.dart';
import 'sortable_example_2.dart';
import 'sortable_example_3.dart';
import 'sortable_example_4.dart';
import 'sortable_example_5.dart';
import 'sortable_example_6.dart';

const ComponentExample sortableExample1 = ComponentExample(
  title: "Example",
  builder: _buildSortableExample1,
  code: "import 'package:docs/ui/shadcn/shadcn_ui.dart';\n\nclass SortableExample1 extends StatefulWidget {\n  const SortableExample1({super.key});\n\n  @override\n  State<SortableExample1> createState() => _SortableExample1State();\n}\n\nclass _SortableExample1State extends State<SortableExample1> {\n  // Two separate lists for demonstrating cross-list drag-and-drop.\n  List<SortableData<String>> invited = [\n    const SortableData('James'),\n    const SortableData('John'),\n    const SortableData('Robert'),\n    const SortableData('Michael'),\n    const SortableData('William'),\n  ];\n  List<SortableData<String>> reserved = [\n    const SortableData('David'),\n    const SortableData('Richard'),\n    const SortableData('Joseph'),\n    const SortableData('Thomas'),\n    const SortableData('Charles'),\n  ];\n\n  @override\n  void initState() {\n    super.initState();\n  }\n\n  @override\n  Widget build(BuildContext context) {\n    return SizedBox(\n      height: 500,\n      child: SortableLayer(\n        // The SortableLayer coordinates drag-over/accept behavior for nested Sortable zones.\n        child: Row(\n          crossAxisAlignment: CrossAxisAlignment.stretch,\n          children: [\n            Expanded(\n              child: Card(\n                child: SortableDropFallback<String>(\n                  // If dropped into empty space in this list, append to the end.\n                  onAccept: (value) {\n                    setState(() {\n                      swapItemInLists(\n                          [invited, reserved], value, invited, invited.length);\n                    });\n                  },\n                  child: Column(\n                    crossAxisAlignment: CrossAxisAlignment.stretch,\n                    children: [\n                      for (int i = 0; i < invited.length; i++)\n                        Sortable<String>(\n                          data: invited[i],\n                          // Insert above the current index when dropped at the top edge.\n                          onAcceptTop: (value) {\n                            setState(() {\n                              swapItemInLists(\n                                  [invited, reserved], value, invited, i);\n                            });\n                          },\n                          // Insert below the current index when dropped at the bottom edge.\n                          onAcceptBottom: (value) {\n                            setState(() {\n                              swapItemInLists(\n                                  [invited, reserved], value, invited, i + 1);\n                            });\n                          },\n                          child: OutlinedContainer(\n                            padding: const EdgeInsets.all(12),\n                            child: Center(child: Text(invited[i].data)),\n                          ),\n                        ),\n                    ],\n                  ),\n                ),\n              ),\n            ),\n            gap(12),\n            Expanded(\n              child: Card(\n                child: SortableDropFallback<String>(\n                  // Same behavior for the second list.\n                  onAccept: (value) {\n                    setState(() {\n                      swapItemInLists([invited, reserved], value, reserved,\n                          reserved.length);\n                    });\n                  },\n                  child: Column(\n                    crossAxisAlignment: CrossAxisAlignment.stretch,\n                    children: [\n                      for (int i = 0; i < reserved.length; i++)\n                        Sortable<String>(\n                          data: reserved[i],\n                          onAcceptTop: (value) {\n                            setState(() {\n                              swapItemInLists(\n                                  [invited, reserved], value, reserved, i);\n                            });\n                          },\n                          onAcceptBottom: (value) {\n                            setState(() {\n                              swapItemInLists(\n                                  [invited, reserved], value, reserved, i + 1);\n                            });\n                          },\n                          child: OutlinedContainer(\n                            padding: const EdgeInsets.all(12),\n                            child: Center(child: Text(reserved[i].data)),\n                          ),\n                        ),\n                    ],\n                  ),\n                ),\n              ),\n            ),\n          ],\n        ),\n      ),\n    );\n  }\n}\n",
);

Widget _buildSortableExample1(BuildContext context) {
  return const SortableExample1();
}

const ComponentExample sortableExample2 = ComponentExample(
  title: "Locked Axis Example",
  builder: _buildSortableExample2,
  code: "import 'package:docs/ui/shadcn/shadcn_ui.dart';\n\nclass SortableExample2 extends StatefulWidget {\n  const SortableExample2({super.key});\n\n  @override\n  State<SortableExample2> createState() => _SortableExample2State();\n}\n\nclass _SortableExample2State extends State<SortableExample2> {\n  List<SortableData<String>> names = [\n    const SortableData('James'),\n    const SortableData('John'),\n    const SortableData('Robert'),\n    const SortableData('Michael'),\n    const SortableData('William'),\n  ];\n\n  @override\n  Widget build(BuildContext context) {\n    return SortableLayer(\n      // With lock enabled, the drag overlay is constrained within the layer.\n      lock: true,\n      child: SortableDropFallback<int>(\n        // Dropping outside specific edge targets appends the item to the end.\n        onAccept: (value) {\n          setState(() {\n            names.add(names.removeAt(value.data));\n          });\n        },\n        child: Column(\n          crossAxisAlignment: CrossAxisAlignment.stretch,\n          children: [\n            for (int i = 0; i < names.length; i++)\n              Sortable<String>(\n                // Use a stable key for better drag/reorder behavior.\n                key: ValueKey(i),\n                data: names[i],\n                // Swap into the target index when dropped on the top edge.\n                onAcceptTop: (value) {\n                  setState(() {\n                    names.swapItem(value, i);\n                  });\n                },\n                // Insert after the target when dropped on the bottom edge.\n                onAcceptBottom: (value) {\n                  setState(() {\n                    names.swapItem(value, i + 1);\n                  });\n                },\n                child: OutlinedContainer(\n                  padding: const EdgeInsets.all(12),\n                  child: Center(child: Text(names[i].data)),\n                ),\n              ),\n          ],\n        ),\n      ),\n    );\n  }\n}\n",
);

Widget _buildSortableExample2(BuildContext context) {
  return const SortableExample2();
}

const ComponentExample sortableExample3 = ComponentExample(
  title: "Horizontal Example",
  builder: _buildSortableExample3,
  code: "import 'package:docs/ui/shadcn/shadcn_ui.dart';\n\nclass SortableExample3 extends StatefulWidget {\n  const SortableExample3({super.key});\n\n  @override\n  State<SortableExample3> createState() => _SortableExample3State();\n}\n\nclass _SortableExample3State extends State<SortableExample3> {\n  List<SortableData<String>> names = [\n    const SortableData('James'),\n    const SortableData('John'),\n    const SortableData('Robert'),\n    const SortableData('Michael'),\n    const SortableData('William'),\n  ];\n\n  @override\n  Widget build(BuildContext context) {\n    return SortableLayer(\n      // Constrain the drag overlay within the horizontal strip.\n      lock: true,\n      child: SortableDropFallback<int>(\n        onAccept: (value) {\n          setState(() {\n            names.add(names.removeAt(value.data));\n          });\n        },\n        child: SizedBox(\n          height: 50,\n          child: Row(\n            crossAxisAlignment: CrossAxisAlignment.stretch,\n            mainAxisSize: MainAxisSize.min,\n            children: [\n              for (int i = 0; i < names.length; i++)\n                Sortable<String>(\n                  key: ValueKey(i),\n                  data: names[i],\n                  // For horizontal sorting, drop on the left/right edges to reorder.\n                  onAcceptLeft: (value) {\n                    setState(() {\n                      names.swapItem(value, i);\n                    });\n                  },\n                  onAcceptRight: (value) {\n                    setState(() {\n                      names.swapItem(value, i + 1);\n                    });\n                  },\n                  child: OutlinedContainer(\n                    width: 100,\n                    padding: const EdgeInsets.all(12),\n                    child: Center(child: Text(names[i].data)),\n                  ),\n                ),\n            ],\n          ),\n        ),\n      ),\n    );\n  }\n}\n",
);

Widget _buildSortableExample3(BuildContext context) {
  return const SortableExample3();
}

const ComponentExample sortableExample4 = ComponentExample(
  title: "ListView Example",
  builder: _buildSortableExample4,
  code: "import 'package:docs/ui/shadcn/shadcn_ui.dart';\n\nclass SortableExample4 extends StatefulWidget {\n  const SortableExample4({super.key});\n\n  @override\n  State<SortableExample4> createState() => _SortableExample4State();\n}\n\nclass _SortableExample4State extends State<SortableExample4> {\n  List<SortableData<String>> names = [\n    const SortableData('James'),\n    const SortableData('John'),\n    const SortableData('Robert'),\n    const SortableData('Michael'),\n    const SortableData('William'),\n    const SortableData('David'),\n    const SortableData('Richard'),\n    const SortableData('Joseph'),\n    const SortableData('Thomas'),\n    const SortableData('Charles'),\n    const SortableData('Daniel'),\n    const SortableData('Matthew'),\n    const SortableData('Anthony'),\n    const SortableData('Donald'),\n    const SortableData('Mark'),\n    const SortableData('Paul'),\n    const SortableData('Steven'),\n    const SortableData('Andrew'),\n    const SortableData('Kenneth'),\n  ];\n\n  final ScrollController controller = ScrollController();\n\n  @override\n  Widget build(BuildContext context) {\n    return SizedBox(\n      height: 400,\n      child: SortableLayer(\n        // Constrain drag overlays to the layer bounds so they scroll within the list.\n        lock: true,\n        child: SortableDropFallback<int>(\n          // If dropped outside a specific edge target, append to the end.\n          onAccept: (value) {\n            setState(() {\n              names.add(names.removeAt(value.data));\n            });\n          },\n          // Wrap the scrollable so auto-scrolling can occur while dragging near edges.\n          child: ScrollableSortableLayer(\n            controller: controller,\n            child: ListView.builder(\n              controller: controller,\n              itemBuilder: (context, i) {\n                return Sortable<String>(\n                  // Stable key helps maintain drag state with virtualization.\n                  key: ValueKey(i),\n                  data: names[i],\n                  onAcceptTop: (value) {\n                    setState(() {\n                      names.swapItem(value, i);\n                    });\n                  },\n                  onAcceptBottom: (value) {\n                    setState(() {\n                      names.swapItem(value, i + 1);\n                    });\n                  },\n                  child: OutlinedContainer(\n                    padding: const EdgeInsets.all(12),\n                    child: Center(child: Text(names[i].data)),\n                  ),\n                );\n              },\n              itemCount: names.length,\n            ),\n          ),\n        ),\n      ),\n    );\n  }\n}\n",
);

Widget _buildSortableExample4(BuildContext context) {
  return const SortableExample4();
}

const ComponentExample sortableExample5 = ComponentExample(
  title: "Drag Handle Example",
  builder: _buildSortableExample5,
  code: "import 'package:docs/ui/shadcn/shadcn_ui.dart';\n\nclass SortableExample5 extends StatefulWidget {\n  const SortableExample5({super.key});\n\n  @override\n  State<SortableExample5> createState() => _SortableExample5State();\n}\n\nclass _SortableExample5State extends State<SortableExample5> {\n  List<SortableData<String>> names = [\n    const SortableData('James'),\n    const SortableData('John'),\n    const SortableData('Robert'),\n    const SortableData('Michael'),\n    const SortableData('William'),\n  ];\n\n  @override\n  Widget build(BuildContext context) {\n    return SortableLayer(\n      lock: true,\n      child: SortableDropFallback<int>(\n        // Dropping outside edge targets appends the item to the end.\n        onAccept: (value) {\n          setState(() {\n            names.add(names.removeAt(value.data));\n          });\n        },\n        child: Column(\n          crossAxisAlignment: CrossAxisAlignment.stretch,\n          children: [\n            for (int i = 0; i < names.length; i++)\n              Sortable<String>(\n                key: ValueKey(i),\n                data: names[i],\n                // we only want user to drag the item from the handle,\n                // so we disable the drag on the item itself\n                enabled: false,\n                onAcceptTop: (value) {\n                  setState(() {\n                    names.swapItem(value, i);\n                  });\n                },\n                onAcceptBottom: (value) {\n                  setState(() {\n                    names.swapItem(value, i + 1);\n                  });\n                },\n                child: OutlinedContainer(\n                  padding: const EdgeInsets.all(12),\n                  child: Row(\n                    children: [\n                      // Only this handle starts the drag; the rest of the row is inert.\n                      const SortableDragHandle(child: Icon(Icons.drag_handle)),\n                      const SizedBox(width: 8),\n                      Expanded(child: Text(names[i].data)),\n                    ],\n                  ),\n                ),\n              ),\n          ],\n        ),\n      ),\n    );\n  }\n}\n",
);

Widget _buildSortableExample5(BuildContext context) {
  return const SortableExample5();
}

const ComponentExample sortableExample6 = ComponentExample(
  title: "Remove Item Example",
  builder: _buildSortableExample6,
  code: "import 'package:docs/ui/shadcn/shadcn_ui.dart';\n\nclass SortableExample6 extends StatefulWidget {\n  const SortableExample6({super.key});\n\n  @override\n  State<SortableExample6> createState() => _SortableExample6State();\n}\n\nclass _SortableExample6State extends State<SortableExample6> {\n  late List<SortableData<String>> names;\n\n  @override\n  void initState() {\n    super.initState();\n    _reset();\n  }\n\n  void _reset() {\n    names = [\n      const SortableData('James'),\n      const SortableData('John'),\n      const SortableData('Robert'),\n      const SortableData('Michael'),\n      const SortableData('William'),\n    ];\n  }\n\n  @override\n  Widget build(BuildContext context) {\n    return SortableLayer(\n      child: Builder(\n          // this builder is needed to access the context of the SortableLayer\n          builder: (context) {\n        return SortableDropFallback<int>(\n          onAccept: (value) {\n            setState(() {\n              names.add(names.removeAt(value.data));\n            });\n          },\n          child: Column(\n            crossAxisAlignment: CrossAxisAlignment.stretch,\n            children: [\n              PrimaryButton(\n                onPressed: () {\n                  setState(() {\n                    _reset();\n                  });\n                },\n                child: const Text('Reset'),\n              ),\n              for (int i = 0; i < names.length; i++)\n                Sortable<String>(\n                  key: ValueKey(i),\n                  data: names[i],\n                  // we only want user to drag the item from the handle,\n                  // so we disable the drag on the item itself\n                  enabled: false,\n                  onAcceptTop: (value) {\n                    setState(() {\n                      names.swapItem(value, i);\n                    });\n                  },\n                  onAcceptBottom: (value) {\n                    setState(() {\n                      names.swapItem(value, i + 1);\n                    });\n                  },\n                  onDropFailed: () {\n                    // Remove the item from the list if the drop failed\n                    setState(() {\n                      var removed = names.removeAt(i);\n                      // Ensure the drag overlay exists and then dismiss it so\n                      // the item does not animate back to its original position.\n                      SortableLayer.ensureAndDismissDrop(context, removed);\n                      // Dismissing drop will prevent the SortableLayer from\n                      // animating the item back to its original position\n                    });\n                  },\n                  child: OutlinedContainer(\n                    padding: const EdgeInsets.all(12),\n                    child: Row(\n                      children: [\n                        const SortableDragHandle(\n                            child: Icon(Icons.drag_handle)),\n                        const SizedBox(width: 8),\n                        Expanded(child: Text(names[i].data)),\n                      ],\n                    ),\n                  ),\n                ),\n            ],\n          ),\n        );\n      }),\n    );\n  }\n}\n",
);

Widget _buildSortableExample6(BuildContext context) {
  return const SortableExample6();
}

const List<ComponentExample> sortableExamples = [
  sortableExample1,
  sortableExample2,
  sortableExample3,
  sortableExample4,
  sortableExample5,
  sortableExample6,
];
