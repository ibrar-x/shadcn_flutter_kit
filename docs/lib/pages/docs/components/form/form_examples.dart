import 'package:flutter/widgets.dart';
import '../../component_example_models.dart';
import 'form_example_1.dart';
import 'form_example_2.dart';
import 'form_example_3.dart';

const ComponentExample formExample1 = ComponentExample(
  title: "Form Example (Table Layout)",
  builder: _buildFormExample1,
  code: "import 'dart:convert';\n\nimport 'package:docs/ui/shadcn/shadcn_ui.dart';\n\nclass FormExample1 extends StatefulWidget {\n  const FormExample1({super.key});\n\n  @override\n  State<FormExample1> createState() => _FormExample1State();\n}\n\nclass _FormExample1State extends State<FormExample1> {\n  final _usernameKey = const TextFieldKey('username');\n  final _passwordKey = const TextFieldKey('password');\n  final _confirmPasswordKey = const TextFieldKey('confirmPassword');\n  @override\n  Widget build(BuildContext context) {\n    return SizedBox(\n      width: 480,\n      child: Form(\n        // Submit handler receives a typed map of field keys to values.\n        onSubmit: (context, values) {\n          // Get the values individually\n          String? username = _usernameKey[values];\n          String? password = _passwordKey[values];\n          String? confirmPassword = _confirmPasswordKey[values];\n          // or just encode the whole map to JSON directly\n          String json = jsonEncode(values.map((key, value) {\n            return MapEntry(key.key, value);\n          }));\n          showDialog(\n            context: context,\n            builder: (context) {\n              return AlertDialog(\n                title: const Text('Form Values'),\n                content: Column(\n                  mainAxisSize: MainAxisSize.min,\n                  crossAxisAlignment: CrossAxisAlignment.start,\n                  children: [\n                    Text('Username: \$username'),\n                    Text('Password: \$password'),\n                    Text('Confirm Password: \$confirmPassword'),\n                    Text('JSON: \$json'),\n                  ],\n                ),\n                actions: [\n                  PrimaryButton(\n                    onPressed: () => Navigator.of(context).pop(),\n                    child: const Text('Close'),\n                  ),\n                ],\n              );\n            },\n          );\n        },\n        child: Column(\n          mainAxisSize: MainAxisSize.min,\n          crossAxisAlignment: CrossAxisAlignment.end,\n          children: [\n            FormTableLayout(\n              rows: [\n                FormField(\n                  key: _usernameKey,\n                  label: const Text('Username'),\n                  hint: const Text('This is your public display name'),\n                  validator: const LengthValidator(min: 4),\n                  child: const TextField(\n                    initialValue: 'sunarya-thito',\n                  ),\n                ),\n                FormField(\n                  key: _passwordKey,\n                  label: const Text('Password'),\n                  validator: const LengthValidator(min: 8),\n                  child: const TextField(\n                    obscureText: true,\n                  ),\n                ),\n                FormField(\n                  key: _confirmPasswordKey,\n                  label: const Text('Confirm Password'),\n                  validator: CompareWith.equal(_passwordKey,\n                      message: 'Passwords do not match'),\n                  child: const TextField(\n                    obscureText: true,\n                  ),\n                ),\n              ],\n            ),\n            const Gap(24),\n            FormErrorBuilder(\n              builder: (context, errors, child) {\n                // Disable the submit button while there are validation errors.\n                return PrimaryButton(\n                  onPressed: errors.isEmpty ? () => context.submitForm() : null,\n                  child: const Text('Submit'),\n                );\n              },\n            )\n          ],\n        ),\n      ),\n    );\n  }\n}\n",
);

Widget _buildFormExample1(BuildContext context) {
  return const FormExample1();
}

const ComponentExample formExample2 = ComponentExample(
  title: "Form Example (Column Layout)",
  builder: _buildFormExample2,
  code: "import 'dart:convert';\n\nimport 'package:docs/ui/shadcn/shadcn_ui.dart';\n\nclass FormExample2 extends StatefulWidget {\n  const FormExample2({super.key});\n\n  @override\n  State<FormExample2> createState() => _FormExample2State();\n}\n\nclass _FormExample2State extends State<FormExample2> {\n  final _usernameKey = const TextFieldKey(#username);\n  final _passwordKey = const TextFieldKey(#password);\n  final _confirmPasswordKey = const TextFieldKey(#confirmPassword);\n  final _agreeKey = const CheckboxKey(#agree);\n  CheckboxState state = CheckboxState.unchecked;\n  @override\n  Widget build(BuildContext context) {\n    return SizedBox(\n      width: 480,\n      child: Form(\n        onSubmit: (context, values) {\n          // Get the values individually\n          String? username = _usernameKey[values];\n          String? password = _passwordKey[values];\n          String? confirmPassword = _confirmPasswordKey[values];\n          CheckboxState? agree = _agreeKey[values];\n          // or just encode the whole map to JSON directly\n          String json = jsonEncode(values.map((key, value) {\n            return MapEntry(key.key, value);\n          }));\n          showDialog(\n            context: context,\n            builder: (context) {\n              return AlertDialog(\n                title: const Text('Form Values'),\n                content: Column(\n                  mainAxisSize: MainAxisSize.min,\n                  crossAxisAlignment: CrossAxisAlignment.start,\n                  children: [\n                    Text('Username: \$username'),\n                    Text('Password: \$password'),\n                    Text('Confirm Password: \$confirmPassword'),\n                    Text('Agree: \$agree'),\n                    Text('JSON: \$json'),\n                  ],\n                ),\n                actions: [\n                  PrimaryButton(\n                    onPressed: () => Navigator.of(context).pop(),\n                    child: const Text('Close'),\n                  ),\n                ],\n              );\n            },\n          );\n        },\n        child: Column(\n          mainAxisSize: MainAxisSize.min,\n          crossAxisAlignment: CrossAxisAlignment.end,\n          children: [\n            Column(\n              crossAxisAlignment: CrossAxisAlignment.stretch,\n              children: [\n                FormField(\n                  key: _usernameKey,\n                  label: const Text('Username'),\n                  hint: const Text('This is your public display name'),\n                  validator: const LengthValidator(min: 4),\n                  // Show validation messages when the value changes and after submit.\n                  showErrors: const {\n                    FormValidationMode.changed,\n                    FormValidationMode.submitted\n                  },\n                  child: const TextField(),\n                ),\n                FormField(\n                  key: _passwordKey,\n                  label: const Text('Password'),\n                  validator: const LengthValidator(min: 8),\n                  // Same validation visibility behavior for password.\n                  showErrors: const {\n                    FormValidationMode.changed,\n                    FormValidationMode.submitted\n                  },\n                  child: const TextField(\n                    obscureText: true,\n                  ),\n                ),\n                FormField(\n                  key: _confirmPasswordKey,\n                  label: const Text('Confirm Password'),\n                  validator: CompareWith.equal(_passwordKey,\n                      message: 'Passwords do not match'),\n                  // Mirror validation visibility on confirm.\n                  showErrors: const {\n                    FormValidationMode.changed,\n                    FormValidationMode.submitted\n                  },\n                  child: const TextField(\n                    obscureText: true,\n                  ),\n                ),\n                FormInline(\n                  key: _agreeKey,\n                  label: const Text('I agree to the terms and conditions'),\n                  validator: const CompareTo.equal(CheckboxState.checked,\n                      message: 'You must agree to the terms and conditions'),\n                  // Inline field with a trailing checkbox and same visibility behavior.\n                  showErrors: const {\n                    FormValidationMode.changed,\n                    FormValidationMode.submitted\n                  },\n                  child: Align(\n                    alignment: AlignmentDirectional.centerEnd,\n                    child: Checkbox(\n                        state: state,\n                        onChanged: (value) {\n                          setState(() {\n                            state = value;\n                          });\n                        }),\n                  ),\n                ),\n              ],\n            ).gap(24),\n            const Gap(24),\n            FormErrorBuilder(\n              builder: (context, errors, child) {\n                return PrimaryButton(\n                  onPressed: errors.isEmpty ? () => context.submitForm() : null,\n                  child: const Text('Submit'),\n                );\n              },\n            )\n          ],\n        ),\n      ),\n    );\n  }\n}\n",
);

Widget _buildFormExample2(BuildContext context) {
  return const FormExample2();
}

const ComponentExample formExample3 = ComponentExample(
  title: "Validation Mode Example",
  builder: _buildFormExample3,
  code: "import 'dart:convert';\n\nimport 'package:docs/ui/shadcn/shadcn_ui.dart';\n\nclass FormExample3 extends StatefulWidget {\n  const FormExample3({super.key});\n\n  @override\n  State<FormExample3> createState() => _FormExample3State();\n}\n\nclass _FormExample3State extends State<FormExample3> {\n  final _dummyData = [\n    'sunarya-thito',\n    'septogeddon',\n    'shadcn',\n  ];\n\n  final _usernameKey = const TextFieldKey('username');\n  final _passwordKey = const TextFieldKey('password');\n  final _confirmPasswordKey = const TextFieldKey('confirmPassword');\n  @override\n  Widget build(BuildContext context) {\n    return SizedBox(\n      width: 480,\n      child: Form(\n        onSubmit: (context, values) {\n          showDialog(\n            context: context,\n            builder: (context) {\n              return AlertDialog(\n                title: const Text('Form Values'),\n                content: Text(jsonEncode(values.map(\n                  (key, value) {\n                    return MapEntry(key.key, value);\n                  },\n                ))),\n                actions: [\n                  PrimaryButton(\n                    onPressed: () => Navigator.of(context).pop(),\n                    child: const Text('Close'),\n                  ),\n                ],\n              );\n            },\n          );\n        },\n        child: Column(\n          mainAxisSize: MainAxisSize.min,\n          crossAxisAlignment: CrossAxisAlignment.end,\n          children: [\n            FormTableLayout(\n              rows: [\n                FormField(\n                  key: _usernameKey,\n                  label: const Text('Username'),\n                  hint: const Text('This is your public display name'),\n                  // Combine validators: length + async availability check,\n                  // but only run the async validator on submit.\n                  validator: const LengthValidator(min: 4) &\n                      ValidationMode(\n                        ConditionalValidator((value) async {\n                          // simulate a network delay for example purpose\n                          await Future.delayed(const Duration(seconds: 1));\n                          return !_dummyData.contains(value);\n                        }, message: 'Username already taken'),\n                        // only validate when the form is submitted\n                        mode: {FormValidationMode.submitted},\n                      ),\n                  child: const TextField(\n                    initialValue: 'sunarya-thito',\n                  ),\n                ),\n                FormField(\n                  key: _passwordKey,\n                  label: const Text('Password'),\n                  validator: const LengthValidator(min: 8),\n                  showErrors: const {\n                    FormValidationMode.submitted,\n                    FormValidationMode.changed\n                  },\n                  child: const TextField(\n                    obscureText: true,\n                  ),\n                ),\n                FormField<String>(\n                  key: _confirmPasswordKey,\n                  label: const Text('Confirm Password'),\n                  showErrors: const {\n                    FormValidationMode.submitted,\n                    FormValidationMode.changed\n                  },\n                  validator: CompareWith.equal(_passwordKey,\n                      message: 'Passwords do not match'),\n                  child: const TextField(\n                    obscureText: true,\n                  ),\n                ),\n              ],\n            ),\n            const Gap(24),\n            const SubmitButton(\n              loadingTrailing: AspectRatio(\n                aspectRatio: 1,\n                child: CircularProgressIndicator(\n                  onSurface: true,\n                ),\n              ),\n              child: Text('Register'),\n            ),\n          ],\n        ),\n      ),\n    );\n  }\n}\n",
);

Widget _buildFormExample3(BuildContext context) {
  return const FormExample3();
}

const List<ComponentExample> formExamples = [
  formExample1,
  formExample2,
  formExample3,
];