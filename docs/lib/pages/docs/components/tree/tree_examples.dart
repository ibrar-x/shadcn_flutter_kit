import 'package:flutter/widgets.dart';
import '../../component_example_models.dart';
import 'tree_example_1.dart';

const ComponentExample treeExample1 = ComponentExample(
  title: "Example",
  builder: _buildTreeExample1,
  code: "import 'package:docs/shadcn_ui.dart';\n\n// Demonstrates TreeView with expandable items, branch lines (path/line),\n// and optional recursive selection behavior.\n\nclass TreeExample1 extends StatefulWidget {\n  const TreeExample1({super.key});\n\n  @override\n  State<TreeExample1> createState() => _TreeExample1State();\n}\n\nclass _TreeExample1State extends State<TreeExample1> {\n  bool expandIcon = false;\n  bool usePath = true;\n  bool recursiveSelection = false;\n  List<TreeNode<String>> treeItems = [\n    TreeItem(\n      data: 'Apple',\n      expanded: true,\n      children: [\n        TreeItem(data: 'Red Apple', children: [\n          TreeItem(data: 'Red Apple 1'),\n          TreeItem(data: 'Red Apple 2'),\n        ]),\n        TreeItem(data: 'Green Apple'),\n      ],\n    ),\n    TreeItem(\n      data: 'Banana',\n      children: [\n        TreeItem(data: 'Yellow Banana'),\n        TreeItem(data: 'Green Banana', children: [\n          TreeItem(data: 'Green Banana 1'),\n          TreeItem(data: 'Green Banana 2'),\n          TreeItem(data: 'Green Banana 3'),\n        ]),\n      ],\n    ),\n    TreeItem(\n      data: 'Cherry',\n      children: [\n        TreeItem(data: 'Red Cherry'),\n        TreeItem(data: 'Green Cherry'),\n      ],\n    ),\n    TreeItem(\n      data: 'Date',\n    ),\n    // Tree Root acts as a parent node with no data,\n    // it will flatten the children into the parent node\n    TreeRoot(\n      children: [\n        TreeItem(\n          data: 'Elderberry',\n          children: [\n            TreeItem(data: 'Black Elderberry'),\n            TreeItem(data: 'Red Elderberry'),\n          ],\n        ),\n        TreeItem(\n          data: 'Fig',\n          children: [\n            TreeItem(data: 'Green Fig'),\n            TreeItem(data: 'Purple Fig'),\n          ],\n        ),\n      ],\n    ),\n  ];\n\n  @override\n  Widget build(BuildContext context) {\n    return Column(\n      mainAxisSize: MainAxisSize.min,\n      children: [\n        OutlinedContainer(\n          child: SizedBox(\n            height: 300,\n            width: 250,\n            child: TreeView(\n              // Show a separate expand/collapse icon when true; otherwise use row affordance.\n              expandIcon: expandIcon,\n              shrinkWrap: true,\n              // When true, selecting a parent can affect children (see below toggle).\n              recursiveSelection: recursiveSelection,\n              nodes: treeItems,\n              // Draw connecting lines either as path curves or straight lines.\n              branchLine: usePath ? BranchLine.path : BranchLine.line,\n              // Use a built-in handler to update selection state across nodes.\n              onSelectionChanged: TreeView.defaultSelectionHandler(\n                treeItems,\n                (value) {\n                  setState(() {\n                    treeItems = value;\n                  });\n                },\n              ),\n              builder: (context, node) {\n                return TreeItemView(\n                  onPressed: () {},\n                  trailing: node.leaf\n                      ? Container(\n                          width: 16,\n                          height: 16,\n                          alignment: Alignment.center,\n                          child: const CircularProgressIndicator(),\n                        )\n                      : null,\n                  leading: node.leaf\n                      ? const Icon(BootstrapIcons.fileImage)\n                      : Icon(node.expanded\n                          ? BootstrapIcons.folder2Open\n                          : BootstrapIcons.folder2),\n                  // Expand/collapse handling; updates treeItems with new expanded state.\n                  onExpand: TreeView.defaultItemExpandHandler(treeItems, node,\n                      (value) {\n                    setState(() {\n                      treeItems = value;\n                    });\n                  }),\n                  child: Text(node.data),\n                );\n              },\n            ),\n          ),\n        ),\n        const Gap(16),\n        Row(\n          mainAxisSize: MainAxisSize.min,\n          children: [\n            PrimaryButton(\n              onPressed: () {\n                setState(() {\n                  treeItems = treeItems.expandAll();\n                });\n              },\n              child: const Text('Expand All'),\n            ),\n            const Gap(8),\n            PrimaryButton(\n              onPressed: () {\n                setState(() {\n                  treeItems = treeItems.collapseAll();\n                });\n              },\n              child: const Text('Collapse All'),\n            ),\n          ],\n        ),\n        const Gap(8),\n        Checkbox(\n          state: expandIcon ? CheckboxState.checked : CheckboxState.unchecked,\n          onChanged: (value) {\n            setState(() {\n              expandIcon = value == CheckboxState.checked;\n            });\n          },\n          trailing: const Text('Expand Icon'),\n        ),\n        const Gap(8),\n        Checkbox(\n          state: usePath ? CheckboxState.checked : CheckboxState.unchecked,\n          onChanged: (value) {\n            setState(() {\n              usePath = value == CheckboxState.checked;\n            });\n          },\n          trailing: const Text('Use Path Branch Line'),\n        ),\n        const Gap(8),\n        Checkbox(\n          state: recursiveSelection\n              ? CheckboxState.checked\n              : CheckboxState.unchecked,\n          onChanged: (value) {\n            setState(() {\n              recursiveSelection = value == CheckboxState.checked;\n              if (recursiveSelection) {\n                // Update nodes so parent/child reflect selected state recursively.\n                treeItems = treeItems.updateRecursiveSelection();\n              }\n            });\n          },\n          trailing: const Text('Recursive Selection'),\n        ),\n      ],\n    );\n  }\n}\n",
);

Widget _buildTreeExample1(BuildContext context) {
  return const TreeExample1();
}

const List<ComponentExample> treeExamples = [
  treeExample1,
];
