{
  "schemaVersion": 1,
  "id": "filter_bar",
  "name": "Filter Bar",
  "description": "Controlled filter header with search, sort, chips, date range, and clear-all actions.",
  "install": "flutter_shadcn add filter_bar",
  "import": "import 'package:<your_app>/ui/shadcn/layout/filter_bar/filter_bar.dart';",
  "whenToUse": {
    "use": [
      "you need a consistent filter toolbar for any user-defined content surface.",
      "filtering state is owned by the page and passed down as a single object."
    ],
    "avoid": [
      "you only need one simple search field.",
      "filtering must be coupled to data fetching inside the widget."
    ]
  },
  "examples": {
    "minimal": "final controller = FilterBarController(\n  const FilterState(sortId: 'newest'),\n);\n\nFilterBar(\n  controller: controller,\n  sortOptions: const [\n    FilterSortOption(id: 'newest', label: 'Newest'),\n    FilterSortOption(id: 'oldest', label: 'Oldest'),\n  ],\n  resultsCount: 42,\n)"
  },
  "patterns": [
    {
      "title": "Typed custom filters",
      "code": "final statusField = FilterField<String>(\n  id: 'status',\n  matcher: FilterMatchers.exact(),\n);\n\nFilterBar(\n  state: state,\n  customFilters: [\n    FilterCustomFilter.typed<String>(\n      field: statusField,\n      builder: (context, value, onChanged) {\n        return Select<String>(\n          value: value,\n          canUnselect: true,\n          placeholder: const Text('Status'),\n          onChanged: onChanged,\n          itemBuilder: (context, value) => Text(value),\n          popup: SelectPopup<String>(\n            items: SelectItemList(\n              children: const [\n                SelectItemButton<String>(value: 'open', child: Text('Open')),\n                SelectItemButton<String>(value: 'closed', child: Text('Closed')),\n              ],\n            ),\n          ).call,\n        );\n      },\n    ),\n  ],\n  onStateChanged: (next) => setState(() => state = next),\n)"
    },
    {
      "title": "Sheet presentation with groups",
      "code": "FilterBar(\n  controller: controller,\n  presentation: FilterBarPresentation.autoSheet,\n  sheetBreakpoint: 720,\n  sheetTitle: 'Filters',\n  groups: const [\n    FilterGroup(\n      id: 'catalog',\n      title: 'Catalog',\n      filterIds: ['category', 'brand'],\n    ),\n  ],\n)"
    },
    {
      "title": "Explicit model bindings",
      "code": "final bindings = <FilterBinding<Order>>[\n  TypedFilterBinding<Order, String>(\n    field: emailField,\n    selector: (order) => order.email,\n  ),\n  TypedFilterBinding<Order, double>(\n    field: revenueField,\n    selector: (order) => order.revenue,\n  ),\n];\n\nfinal filteredOrders = state.whereMatches(orders, bindings).toList();"
    },
    {
      "title": "Multi matcher + custom matcher",
      "code": "final brandField = FilterField<String>(\n  id: 'brand_query',\n  defaultMatcherId: 'contains',\n  matchers: [\n    FilterMatcherOption(\n      id: 'contains',\n      label: 'Contains',\n      matcher: FilterMatchers.contains(),\n    ),\n    FilterMatcherOption(\n      id: 'starts_with',\n      label: 'Starts with',\n      matcher: FilterMatchers.startsWith(),\n    ),\n    FilterMatcherOption(\n      id: 'custom',\n      label: 'Custom',\n      matcher: FilterMatcher<String>((selected, candidate) {\n        return candidate is String && candidate.endsWith(selected);\n      }),\n    ),\n  ],\n);\n\nstate = state\n    .setValue(brandField, 'app')\n    .setMatcherIdOf(brandField, 'starts_with');"
    },
    {
      "title": "Trailing page-specific widgets",
      "code": "FilterBar(\n  state: state,\n  trailingFilters: [\n    StatusSelect(\n      value: selectedStatus,\n      onChanged: (status) {\n        final chips = [\n          ...state.chips.where((c) => !c.key.startsWith('status:')),\n          if (status != null)\n            FilterChipData(\n              key: 'status:$status',\n              label: 'Status: ${status.label}',\n            ),\n        ];\n        onStateChanged(state.copyWith(chips: chips));\n      },\n    ),\n  ],\n  onStateChanged: (next) => setState(() => state = next),\n)"
    }
  ],
  "api": {
    "constructors": [
      "`FilterBar`",
      "`state` (`FilterState?`, required if `controller` is null)",
      "`onStateChanged` (`ValueChanged<FilterState>?`, required if `controller` is null)",
      "`controller` (`FilterBarController?`, optional)",
      "`sortOptions` (`List<FilterSortOption>`, optional)",
      "`enableDateRange` (`bool`, optional)",
      "`resultsCount` (`int?`, optional)",
      "`searchPlaceholder` (`String`, optional)",
      "`searchLabel` (`String`, optional)",
      "`searchDebounce` (`Duration?`, optional)",
      "`trailingFilters` (`List<Widget>`, optional)",
      "`customFilters` (`List<FilterCustomFilter>`, optional)",
      "`style` (`FilterBarStyle?`, optional)",
      "`clearPolicy` (`FilterClearPolicy`, optional)",
      "`onClearAll` (`FilterState Function(FilterState current)?`, optional)",
      "`showClearAllWhenEmpty` (`bool`, optional)",
      "`presentation` (`FilterBarPresentation`, optional, default: `autoSheet`)",
      "`sheetBreakpoint` (`double`, optional, default: `720`)",
      "`sheetTriggerLabel` (`String`, optional)",
      "`sheetTitle` (`String`, optional)",
      "`sheetPosition` (`OverlayPosition`, optional, default: `OverlayPosition.bottom`)",
      "`groups` (`List<FilterGroup>`, optional)",
      "`clearPolicy.clearCustomFilters` (`bool`, optional, default: `true`)"
    ],
    "callbacks": [
      "`onStateChanged` emits the next `FilterState` whenever the UI changes.",
      "`onClearAll` optionally overrides clear-all behavior with custom policy logic."
    ]
  },
  "theming": [
    "The widget pulls colors/typography from `Theme.of(context)` and supports compact density through `FilterBarStyle`.",
    "Keep app-level look consistent by overriding `FilterBarStyle` rather than forking behavior."
  ],
  "accessibility": [
    "Search input uses a dedicated label for semantic clarity.",
    "Clear-all action is disabled when no filters are active.",
    "Chips expose delete actions with semantic tooltips."
  ],
  "do": [
    "Keep chip keys stable and namespaced (`status:`, `tag:`, `assignee:`).",
    "Drive queries from `onStateChanged` in page state."
  ],
  "dont": [
    "Fetch data directly inside `FilterBar`.",
    "Mutate chip labels/keys in place without emitting a new `FilterState`."
  ],
  "related": [],
  "registryRules": [
    "One public class in `filter_bar.dart`",
    "Helpers under `_impl/`"
  ]
}
